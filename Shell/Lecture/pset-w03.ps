%!PS-Adobe-3.0
%%Creator: groff version 1.22.2
%%CreationDate: Wed Oct  4 21:10:25 2017
%%DocumentNeededResources: font Times-Roman
%%+ font Times-Bold
%%+ font Courier
%%DocumentSuppliedResources: procset grops 1.22 2
%%Pages: 3
%%PageOrder: Ascend
%%DocumentMedia: Default 612 792 0 () ()
%%Orientation: Portrait
%%EndComments
%%BeginDefaults
%%PageMedia: Default
%%EndDefaults
%%BeginProlog
%%BeginResource: procset grops 1.22 2
%!PS-Adobe-3.0 Resource-ProcSet
/setpacking where{
pop
currentpacking
true setpacking
}if
/grops 120 dict dup begin
/SC 32 def
/A/show load def
/B{0 SC 3 -1 roll widthshow}bind def
/C{0 exch ashow}bind def
/D{0 exch 0 SC 5 2 roll awidthshow}bind def
/E{0 rmoveto show}bind def
/F{0 rmoveto 0 SC 3 -1 roll widthshow}bind def
/G{0 rmoveto 0 exch ashow}bind def
/H{0 rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/I{0 exch rmoveto show}bind def
/J{0 exch rmoveto 0 SC 3 -1 roll widthshow}bind def
/K{0 exch rmoveto 0 exch ashow}bind def
/L{0 exch rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/M{rmoveto show}bind def
/N{rmoveto 0 SC 3 -1 roll widthshow}bind def
/O{rmoveto 0 exch ashow}bind def
/P{rmoveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/Q{moveto show}bind def
/R{moveto 0 SC 3 -1 roll widthshow}bind def
/S{moveto 0 exch ashow}bind def
/T{moveto 0 exch 0 SC 5 2 roll awidthshow}bind def
/SF{
findfont exch
[exch dup 0 exch 0 exch neg 0 0]makefont
dup setfont
[exch/setfont cvx]cvx bind def
}bind def
/MF{
findfont
[5 2 roll
0 3 1 roll
neg 0 0]makefont
dup setfont
[exch/setfont cvx]cvx bind def
}bind def
/level0 0 def
/RES 0 def
/PL 0 def
/LS 0 def
/MANUAL{
statusdict begin/manualfeed true store end
}bind def
/PLG{
gsave newpath clippath pathbbox grestore
exch pop add exch pop
}bind def
/BP{
/level0 save def
1 setlinecap
1 setlinejoin
DEFS/BPhook known{DEFS begin BPhook end}if
72 RES div dup scale
LS{
90 rotate
}{
0 PL translate
}ifelse
1 -1 scale
}bind def
/EP{
level0 restore
showpage
}def
/DA{
newpath arcn stroke
}bind def
/SN{
transform
.25 sub exch .25 sub exch
round .25 add exch round .25 add exch
itransform
}bind def
/DL{
SN
moveto
SN
lineto stroke
}bind def
/DC{
newpath 0 360 arc closepath
}bind def
/TM matrix def
/DE{
TM currentmatrix pop
translate scale newpath 0 0 .5 0 360 arc closepath
TM setmatrix
}bind def
/RC/rcurveto load def
/RL/rlineto load def
/ST/stroke load def
/MT/moveto load def
/CL/closepath load def
/Fr{
setrgbcolor fill
}bind def
/setcmykcolor where{
pop
/Fk{
setcmykcolor fill
}bind def
}if
/Fg{
setgray fill
}bind def
/FL/fill load def
/LW/setlinewidth load def
/Cr/setrgbcolor load def
/setcmykcolor where{
pop
/Ck/setcmykcolor load def
}if
/Cg/setgray load def
/RE{
findfont
dup maxlength 1 index/FontName known not{1 add}if dict begin
{
1 index/FID ne
2 index/UniqueID ne
and
{def}{pop pop}ifelse
}forall
/Encoding exch def
dup/FontName exch def
currentdict end definefont pop
}bind def
/DEFS 0 def
/EBEGIN{
moveto
DEFS begin
}bind def
/EEND/end load def
/CNT 0 def
/level1 0 def
/PBEGIN{
/level1 save def
translate
div 3 1 roll div exch scale
neg exch neg exch translate
0 setgray
0 setlinecap
1 setlinewidth
0 setlinejoin
10 setmiterlimit
[]0 setdash
/setstrokeadjust where{
pop
false setstrokeadjust
}if
/setoverprint where{
pop
false setoverprint
}if
newpath
/CNT countdictstack def
userdict begin
/showpage{}def
/setpagedevice{}def
mark
}bind def
/PEND{
cleartomark
countdictstack CNT sub{end}repeat
level1 restore
}bind def
end def
/setpacking where{
pop
setpacking
}if
%%EndResource
%%EndProlog
%%BeginSetup
%%BeginFeature: *PageSize Default
<< /PageSize [ 612 792 ] /ImagingBBox null >> setpagedevice
%%EndFeature
%%IncludeResource: font Times-Roman
%%IncludeResource: font Times-Bold
%%IncludeResource: font Courier
grops begin/DEFS 1 dict def DEFS begin/u{.001 mul}bind def end/RES 72
def/PL 792 def/LS false def/ENC0[/asciicircum/asciitilde/Scaron/Zcaron
/scaron/zcaron/Ydieresis/trademark/quotesingle/Euro/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef/.notdef
/.notdef/.notdef/space/exclam/quotedbl/numbersign/dollar/percent
/ampersand/quoteright/parenleft/parenright/asterisk/plus/comma/hyphen
/period/slash/zero/one/two/three/four/five/six/seven/eight/nine/colon
/semicolon/less/equal/greater/question/at/A/B/C/D/E/F/G/H/I/J/K/L/M/N/O
/P/Q/R/S/T/U/V/W/X/Y/Z/bracketleft/backslash/bracketright/circumflex
/underscore/quoteleft/a/b/c/d/e/f/g/h/i/j/k/l/m/n/o/p/q/r/s/t/u/v/w/x/y
/z/braceleft/bar/braceright/tilde/.notdef/quotesinglbase/guillemotleft
/guillemotright/bullet/florin/fraction/perthousand/dagger/daggerdbl
/endash/emdash/ff/fi/fl/ffi/ffl/dotlessi/dotlessj/grave/hungarumlaut
/dotaccent/breve/caron/ring/ogonek/quotedblleft/quotedblright/oe/lslash
/quotedblbase/OE/Lslash/.notdef/exclamdown/cent/sterling/currency/yen
/brokenbar/section/dieresis/copyright/ordfeminine/guilsinglleft
/logicalnot/minus/registered/macron/degree/plusminus/twosuperior
/threesuperior/acute/mu/paragraph/periodcentered/cedilla/onesuperior
/ordmasculine/guilsinglright/onequarter/onehalf/threequarters
/questiondown/Agrave/Aacute/Acircumflex/Atilde/Adieresis/Aring/AE
/Ccedilla/Egrave/Eacute/Ecircumflex/Edieresis/Igrave/Iacute/Icircumflex
/Idieresis/Eth/Ntilde/Ograve/Oacute/Ocircumflex/Otilde/Odieresis
/multiply/Oslash/Ugrave/Uacute/Ucircumflex/Udieresis/Yacute/Thorn
/germandbls/agrave/aacute/acircumflex/atilde/adieresis/aring/ae/ccedilla
/egrave/eacute/ecircumflex/edieresis/igrave/iacute/icircumflex/idieresis
/eth/ntilde/ograve/oacute/ocircumflex/otilde/odieresis/divide/oslash
/ugrave/uacute/ucircumflex/udieresis/yacute/thorn/ydieresis]def
/Courier@0 ENC0/Courier RE/Times-Bold@0 ENC0/Times-Bold RE/Times-Roman@0
ENC0/Times-Roman RE
%%EndSetup
%%Page: 1 1
%%BeginPageSetup
BP
%%EndPageSetup
/F0 10/Times-Roman@0 SF(ECE357:Computer Operating Systems)69.336 48 Q
(PS 3/pg 1)41.55 E(\2512017 Jef)119.78 E 2.5(fH)-.25 G(akner)-2.5 E/F1
11/Times-Bold@0 SF(The Shell)294.84 97 Q/F2 11/Times-Roman@0 SF .033
(In this assignment, you will write an e)58 116 R .032(xtremely simplis\
tic UNIX shell which is capable of launching one program at a)-.165 F
(time, with ar)58 129 Q(guments, w)-.198 E
(aiting for and reporting the e)-.11 E
(xit status and resource usage statistics.)-.165 E -1.21(Yo)58 148 S
.698(ur shell shall accept lines of input from standard input until EOF)
1.21 F 6.198(.[)-.88 G .698(But see belo)-6.198 F 3.448(wa)-.275 G .698
(bout being in)-3.448 F -.22(vo)-.44 G -.11(ke).22 G 3.448(da).11 G
3.448(sas)-3.448 G(hell)-3.448 E .189(script interpreter!])58 161 R
(Don')5.689 E 2.939(tw)-.198 G .189
(orry about issuing a prompt, command-line editing, etc.)-3.049 F .189
(Each line of input is a command)5.689 F .067(to be e)58 174 R -.165(xe)
-.165 G 2.817(cuted. The).165 F .067(shell should fork to create a)2.817
F F1 .067(new pr)2.817 F(ocess)-.198 E F2 .068
(in which to run the command, set up an)2.817 F 2.818(yr)-.165 G .068
(equested I/O)-2.818 F .817(redirection \(see belo)58 187 R .817(w\), e)
-.275 F -.165(xe)-.165 G 3.567(ct).165 G .817(he program,)-3.567 F/F3 11
/Courier@0 SF(wait)3.567 E F2 .817(for and report the e)3.567 F .817
(xit status, and report the real, user and system)-.165 F .799
(time consumed by the command.)58 200 R .8(This last b)6.3 F .8
(unch of information can be obtained by using the)-.22 F F3(wait3)3.55 E
F2 .8(system call,)3.55 F(with)58 213 Q F3(times)5.16 E F2 2.41
(system call, or with)5.16 F F3(getrusage)5.16 E F2 2.41(system call.)
5.16 F 2.409(Be careful of issues of cummulati)7.91 F 2.739 -.165(ve v)
-.275 H 5.159(sp).165 G(er)-5.159 E(-child)-.22 E(statistics.)58 226 Q
-1.21(Yo)58 245 S 2.75(um)1.21 G
(ay assume that each command is formatted as follo)-2.75 E(ws:)-.275 E
/F4 10/Courier@0 SF(command {argument {argument...} } {redirection_oper\
ation {redirection_operation...}})58 272 Q F2 1.135(This is an e)58 298
R 1.136(xtreme simpli\214cation of shell syntax, b)-.165 F 1.136
(ut this is after all a course in operating systems, not compilers.)-.22
F .395(The abo)58 311 R .725 -.165(ve o)-.165 H .395(ptional ar).165 F
.395(guments and operators are whitespace-delimited, i.e. the)-.198 F
3.145(ya)-.165 G .394(re separated by one or more tabs or)-3.145 F 2.991
(spaces. This)58 324 R .241(will simplify parsing and you can use)2.991
F F3(strtok)2.991 E F2 .242
(to break up the input line into its components.)2.991 F .242(The real)
5.742 F .213(shell accepts)58 337 R F3 .213(command argument>output)
2.963 F F2 .213(as well, b)2.963 F .213(ut you don')-.22 F 2.963(th)
-.198 G -2.475 -.22(av e)-2.963 H .213(to parse that if you don')3.183 F
2.963(tw)-.198 G .213(ant to.)-3.073 F F1 2.963(Al)5.713 G(ine)-2.963 E
1.708(that begins with the # character is a comment and must be ignor)58
350 R(ed.)-.198 E F2 1.709(Report an)7.209 F 4.459(ye)-.165 G 1.709
(rrors related to command)-4.459 F(launching b)58 363 Q(ut, just lik)
-.22 E 2.75(et)-.11 G(he real shell, do not e)-2.75 E
(xit the entire shell on error; just go to the ne)-.165 E(xt command.)
-.165 E(Built-in commands)274.677 389 Q .28(In an)58 415 R 3.03(ys)-.165
G .28(hell, the)-3.03 F F3(cd)3.029 E F2 .279(command must be a b)3.029
F 3.029(uilt-in. This)-.22 F .279(is because the current w)3.029 F .279
(orking directory is an attrib)-.11 F .279(ute of an)-.22 F(y)-.165 E
(gi)58 428 Q -.165(ve)-.275 G 5.966(np).165 G 5.966(rocess. It)-5.966 F
3.217(is changed using the)5.966 F F3(chdir)5.967 E F2 3.217
(system call.)5.967 F 3.217(But if)8.717 F F3(cd)5.967 E F2 3.217
(were an actual program, typing)5.967 F F3(cd)5.967 E(whatever)58 441 Q
F2 .097(into the shell w)2.847 F .097(ould ha)-.11 F .427 -.165(ve n)
-.22 H 2.847(oe).165 G -.275(ff)-2.847 G .097(ect, since it w).275 F
.097(ould only change it for the child \(cd\).)-.11 F .096
(Therefore, if you see)5.597 F(a)58 454 Q F3(cd)3.991 E F2 1.241
(command, implement that as a b)3.991 F 1.241(uilt-in command, and)-.22
F F3(chdir)3.991 E F2 6.741(.Y)C 1.241
(ou can also optionally implement the)-7.951 F F3(pwd)3.991 E F2 -.22
(bu)58 467 S .66(ilt-in command.).22 F .66(Also implement a b)6.16 F
(uilt-in)-.22 E F3(exit)3.41 E F2 .66(command which tak)3.41 F .66
(es an optional single ar)-.11 F 3.41(gument. When)-.198 F(this)3.409 E
.244(command is recei)58 480 R -.165(ve)-.275 G .244
(d, your shell will e).165 F .244(xit immediately)-.165 F 2.994(,w)-.715
G .244(ith a return v)-2.994 F .244(alue as speci\214ed.)-.275 F .245
(See "Exit Status" if no v)5.744 F(alue)-.275 E(is speci\214ed.)58 493 Q
(NO)5.5 E(TE: Y)-.44 E
(ou do not need to implement I/O redirection for the b)-1.21 E
(uilt-in commands.)-.22 E(I/O redirection)284.467 519 Q 1.389
(Support the follo)58 545 R 1.389(wing redirection operations \(note th\
at pipes are not required since we ha)-.275 F -.165(ve)-.22 G(n').165 E
4.138(tt)-.198 G(alk)-4.138 E 1.388(ed about them)-.11 F(yet\):)58 558 Q
F4 55.2(<filename Open)58 572 R(filename and redirect stdin)6 E 55.2
(>filename Open/Create/Truncate)58 586 R(filename and redirect stdout)6
E 49.2(2>filename Open/Create/Truncate)58 600 R
(filename and redirect stderr)6 E 49.2(>>filename Open/Create/Append)58
614 R(filename and redirect stdout)6 E 43.2
(2>>filename Open/Create/Append)58 628 R(filename and redirect stderr)6
E F2 .468(Note that a gi)58 641 R -.165(ve)-.275 G 3.218(nc).165 G .468
(ommand launch can ha)-3.218 F .798 -.165(ve 0)-.22 H 3.218(,1).165 G
3.218(,2o)-3.218 G 3.218(r3p)-3.218 G .468
(ossible redirection operators.)-3.218 F 3.219(Af)5.968 G .469
(ailure to establish an)-3.329 F 3.219(yo)-.165 G(f)-3.219 E .365(the r\
equested I/O redirections should result in an error message and the com\
mand should not be launched.)58 654 R -1.21(Yo)5.865 G 3.115(um)1.21 G
(ay)-3.115 E .042(consider it an error or unde\214ned beha)58 667 R .043
(vior if a gi)-.22 F -.165(ve)-.275 G 2.793<6e8c>.165 G .043
(le descriptor is redirected more than once in a command launch.)-2.793
F -.165(Fo)58 680 S 3.275(rb).165 G .524
(est results, the I/O redirection should be done in the child process.)
-3.275 F .524(This means you could ha)6.024 F .854 -.165(ve a c)-.22 H
.524(hild process).165 F(that f)58 693 Q(ails and e)-.11 E
(xits because of an I/O redirection error)-.165 E 2.75(,p)-.44 G
(rior to the actual child program being e)-2.75 E -.165(xe)-.165 G(c')
.165 E 2.75(d. That')-.55 F 2.75(sO)-.605 G(K.)-2.75 E 0 Cg EP
%%Page: 2 2
%%BeginPageSetup
BP
%%EndPageSetup
/F0 11/Times-Roman@0 SF(ECE357:Computer Operating Systems)36 52 Q
(PS 3/pg 2)78.105 E(\2512017 Jef)164.158 E 2.75(fH)-.275 G(akner)-2.75 E
(Clean File Descriptor En)239.769 104 Q(vironment)-.44 E -1.21(Yo)58 130
S 3.074(ur shell should fork and e)1.21 F -.165(xe)-.165 G 5.824(ct).165
G 3.075(he command with a standard, clean \214le descriptor en)-5.824 F
5.825(vironment. Only)-.44 F(\214le)5.825 E
(descriptors 0, 1 and 2 should be open, possibly redirected as abo)58
143 Q -.165(ve)-.165 G 5.5(.T).165 G
(here should be no "dangling" \214le descriptors.)-5.5 E(Example)297.447
169 Q 2.853(Note that in the e)58 201 R 2.853(xample belo)-.165 F 4.283
-.715(w, t)-.275 H 2.852(here is "deb).715 F 2.852(ugging" output.)-.22
F 2.852(This is permissible, ho)8.352 F(we)-.275 E -.165(ve)-.275 G
3.732 -.44(r, a).165 H 2.852(ll errors and/or).44 F(deb)58 214 Q .017
(ugging must go to standard error)-.22 F 2.767(,N)-.44 G .017
(EVER standard out.)-2.767 F .017(Notice that)5.517 F/F1 11/Courier@0 SF
(ls.out)2.768 E F0 .018(is not polluted with these messages.)2.768 F(Th\
e informational messages such as the amount of time consumed also go to\
 stderr)58 227 Q(.)-.605 E/F2 10/Courier@0 SF 6($m)58 241 S(ysh)-6 E
(cd /some/directory)58 255 Q(Changed directory to /some/directory)58 269
Q(ls -l >ls.out)58 283 Q(Executing command ls with arguments "-l")58 297
Q(Command returned with return code 0,)58 311 Q
(consuming 0.005 real seconds, 0.002 user, 0.001 system)58 325 Q
(end of file read, exiting shell with exit code 0)58 339 Q 6($c)58 353 S
(at ls.out)-6 E(mysh.c)58 367 Q(mysh)58 381 Q($)58 395 Q F0
(Shell Scripts)289.038 434 Q -1.21(Yo)58 466 S
(ur shell must also support being in)1.21 E -.22(vo)-.44 G -.11(ke).22 G
2.75(da).11 G 2.75(sas)-2.75 G(cript interpreter:)-2.75 E F2
(#!/absolute/path/to/your/shell)58 480 Q(#This is an example of a shell\
 script that your shell must execute correctly)58 494 Q
(#notice that lines starting with a # sign are ignored as comments!)58
508 Q(#let's say this here file is called testme.sh.)58 522 Q
(you created it with say)12 E(#vi testme.sh ; chmod +x testme.sh)58 536
Q(#you invoked it with)58 550 Q(#./testme.sh)58 564 Q(cat >cat.out)58
578 Q(#at this point, type some lines at the keyboard, then create an E\
OF \(Ctrl-D\))58 592 Q(#your shell invoked the system cat command with \
output redirected to cat.out)58 606 Q(cat cat.out)58 620 Q
(#you better see the lines that you just typed!)58 634 Q(exit 123)58 648
Q(#after your shell script exits, type echo $? from the UNIX system she\
ll)58 662 Q(#the value should be 123.)58 676 Q
(Since your shell just exited, the following)12 E
(#bogus command should never be seen)58 690 Q 0 Cg EP
%%Page: 3 3
%%BeginPageSetup
BP
%%EndPageSetup
/F0 11/Times-Roman@0 SF(ECE357:Computer Operating Systems)36 52 Q
(PS 3/pg 3)78.105 E(\2512017 Jef)164.158 E 2.75(fH)-.275 G(akner)-2.75 E
/F1 10/Courier@0 SF(#!/absolute/path/to/your/shell)58 105 Q
(#here is another example, say it is called test2.sh)58 119 Q
(#you invoked it with)58 133 Q(#./test2.sh <input.txt)58 147 Q
(cat >cat2.out)58 161 Q(#since you invoked the shell script \(via the s\
ystem shell such as bash\))58 175 Q(#with stdin redirected, your shell \
runs cat which gets stdin from input.txt)58 189 Q(exit)58 203 Q(#the ab\
ove exit had no specified return value, so your shell exited with 0)58
217 Q(#again, test this with echo $?)58 231 Q F0 .162
(In order for this to w)58 258 R .162(ork, your shell must, if pro)-.11
F .162(vided with with an ar)-.165 F .161
(gument, open that \214le and e)-.198 F -.165(xe)-.165 G .161
(cute each line as a).165 F(command \(ignoring comments\).)58 271 Q
(Exit status)293.927 297 Q .353(The e)58 323 R .354
(xit status of your shell itself should be the e)-.165 F .354
(xit code of the last child spa)-.165 F .354(wned if your shell e)-.165
F .354(xits because it sees)-.165 F 1.176(end-of-\214le or the b)58 336
R(uilt-in)-.22 E/F2 11/Courier@0 SF(exit)3.926 E F0 1.175
(command with no speci\214ed e)3.925 F 1.175(xit v)-.165 F 3.925
(alue. If)-.275 F 1.175(the e)3.925 F 1.175(xit is because of an)-.165 F
F2(exit)3.925 E F0 -.22(bu)3.925 G(ilt-in).22 E(command with an e)58 349
Q(xplicit v)-.165 E(alue, that sets the e)-.275 E
(xit code \(see also description under "Built-in commands"\))-.165 E
(Submission)291.326 375 Q -1.21(Yo)58 401 S 1.416(ur submission must in\
clude: source code, "screenshot" demonstrating your shell w)1.21 F 1.416
(orking in an interacti)-.11 F 1.746 -.165(ve c)-.275 H(ase).165 E 1.209
(\(commands from k)58 414 R -.165(ey)-.11 G 1.208
(board\) and also demonstrating that the cd b).165 F 1.208
(uilt-in command w)-.22 F 1.208(orks, screenshot sho)-.11 F 1.208
(wing your)-.275 F .824(shell w)58 427 R .824
(orking as a script interpreter)-.11 F 3.574(,i)-.44 G .824
(ncluding source code of shell script used to test this feature.)-3.574
F -1.21(Yo)6.325 G 3.575(us)1.21 G .825(hould also)-3.575 F
(demonstrate I/O redirection.)58 440 Q 0 Cg EP
%%Trailer
end
%%EOF
